# Getting Started

## Compatibility Overview

This SDK supports both the React Native new and old architecture. There is one known Android limitation: embedded Lucra views use Jetpack Compose, which is not supported by `react-native-screens`. If you need embedded components on Android, stay on the old architecture for now.

Minimum platform requirements:

- iOS deployment target: 15.1
- Android minSdk: 24

## Private Package Access (Required)

Lucra SDK dependencies are hosted in GitHub Packages. You must create a Personal Access Token (PAT) with `packages:read` and `repo` permissions.

1. Create a PAT: https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
2. Name it something like `Lucra Token`.
3. Use it when prompted during install or in CI.

## NPM Install

Create a `.npmrc` at the root of your app:

```
//npm.pkg.github.com/:_authToken=GITHUB_PERSONAL_TOKEN
@lucra-sports:registry=https://npm.pkg.github.com
```

Install the package:

```sh
npm i -s @lucra-sports/lucra-react-native-sdk
```

Do not commit `.npmrc` to your repo. Add it to `.gitignore`.

## Expo (Prebuild/Ejected Only)

This SDK does not work with Expo Go. You must use `expo prebuild`, a dev client, or a standalone build.

### Using Expo Build Properties

Update `app.config.js` to set native build properties and register the Lucra plugin:

```javascript
plugins: [
  [
    'expo-build-properties',
    {
      ios: {
        deploymentTarget: '15.1',
        // Lucra SDK uses third-party services that require network inspection to be kept off.
        networkInspector: false,
      },
      android: {
        minSdkVersion: 24,
        networkInspector: false,
      },
    },
  ],
  '@lucra-sports/lucra-react-native-sdk',
],
```

### Custom Fonts

Follow the `expo-font` guide and ensure Lucra can resolve your font family:

- Android: pass paths relative to `fonts/`.
- iOS: pass the font family name (as shown in Font Book).
- Provide all variations: Regular, Medium, SemiBold, Bold.

### Expo Dev Client

If you use `expo-dev-client`, make sure `networkInspector` is `false`. The SDK uses libraries that block network inspection.

### Venmo Deeplinks (Expo)

Add iOS Info.plist entries for Venmo:

```javascript
infoPlist: {
  CFBundleURLTypes: [
    {
      CFBundleURLSchemes: ['YOUR_APP_BUNDLE_IDENTIFIER.venmo'],
      CFBundleURLName: 'Venmo URL Scheme',
    },
  ],
  LSApplicationQueriesSchemes: ['venmo', 'com.venmo.touch.v2'],
},
```

## iOS Setup

### Deployment Target

Set the minimum iOS version to 15.1:

```
platform :ios, 15.1
```

### CocoaPods Sources

In your `ios/Podfile`, add Lucra's private repo and CocoaPods source at the top:

```ruby
source 'https://github.com/Lucra-Sports/lucra-ios-sdk.git'
source 'https://cdn.cocoapods.org/'

use_frameworks! linkage: :static
```

### Flipper

If you use Flipper, disable it when `use_frameworks!` is enabled:

```ruby
# :flipper_configuration => flipper_config,
flipper_config = FlipperConfiguration.disabled
```

### Add Lucra Private Pod Repo

```sh
pod repo add LucraSDK https://github.com/Lucra-Sports/lucra-ios-sdk
# OR
pod repo add LucraSDK git@github.com/Lucra-Sports/lucra-ios-sdk
```

Example for CI:

```yml
- name: Add private repo to cocoapods
  run: pod repo add LucraSDK https://${{secrets.LUCRA_USERNAME}}:${{secrets.LUCRA_TOKEN}}@github.com/Lucra-Sports/lucra-ios-sdk.git
```

### Required Info.plist Permissions

```
NSBluetoothAlwaysUsageDescription
NSBluetoothPeripheralUsageDescription
NSFaceIDUsageDescription
NSLocalNetworkUsageDescription
NSLocationAlwaysAndWhenInUseUsageDescription
NSLocationAlwaysUsageDescription
NSLocationWhenInUseUsageDescription
NSMotionUsageDescription
NSCameraUsageDescription
NSPhotoLibraryUsageDescription
```

### Firebase (Optional)

If you use `react-native-firebase`, enable static frameworks:

```ruby
# right after `use_frameworks! :linkage => :static`
$RNFirebaseAsStaticFramework = true
```

## Android Setup

### Provide GitHub Packages Credentials

Add PAT credentials either in `~/.gradle/gradle.properties` or your project `gradle.properties` (do not commit):

```gradle
GPR_USER=YOUR_USERNAME
GPR_KEY=YOUR_PAT
```

For CI pipelines, use environment variables:

```yml
env:
  GPR_USER: YOUR_USERNAME
  GPR_KEY: YOUR_PAT
```

### Configure Maven Repository

In your root `android/build.gradle`:

```gradle
allprojects {
  repositories {
    maven {
      name = "LucraGithubPackages"
      url = uri("https://maven.pkg.github.com/Lucra-Sports/lucra-android")
      credentials {
        username = findProperty('GPR_USER') ?: System.getenv('GPR_USER')
        password = findProperty('GPR_KEY') ?: System.getenv('GPR_KEY')
      }
    }
    maven { url "https://zendesk.jfrog.io/zendesk/repo" }
  }
}
```

### Auth0 Compliance (If Your App Does Not Use Auth0)

```gradle
android {
  defaultConfig {
    manifestPlaceholders = [
      'auth0Domain': 'LUCRA_SDK',
      'auth0Scheme': 'LUCRA_SDK'
    ]
  }
}
```

### Minimum API Version

Lucra SDK requires API 24 or higher:

```gradle
// android/build.gradle
buildscript {
  ext {
    minSdkVersion = 24
    targetSdkVersion = 34
    compileSdkVersion = 34
  }
}
```

### Manifest Requirements

```xml
<manifest
  xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools">

  <uses-permission android:name="android.permission.CAMERA" />
  <uses-permission android:name="android.permission.INTERNET" />
  <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
  <uses-permission android:name="android.permission.WAKE_LOCK" />
  <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
  <uses-permission android:name="com.google.android.gms.permission.AD_ID" />
  <uses-permission android:name="android.webkit.PermissionRequest" />
  <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
  <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
  <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
  <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
  <uses-permission android:name="android.permission.READ_PHONE_STATE" />
  <uses-permission android:name="android.permission.USE_BIOMETRIC" />
  <uses-feature android:name="android.hardware.camera.autofocus" />
  <uses-feature android:name="android.hardware.camera" />

  <application>
    <receiver
      android:name="com.geocomply.client.GeoComplyClientBootBroadcastReceiver"
      android:enabled="true"
      android:exported="true">
      <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
        <action android:name="android.intent.action.QUICKBOOT_POWERON" />
      </intent-filter>
    </receiver>

    <service
      android:name="com.geocomply.location.WarmingUpLocationProvidersService"
      android:exported="false" />

    <service
      android:name="com.geocomply.security.GCIsolatedSecurityService"
      android:exported="false"
      android:isolatedProcess="true"
      tools:targetApi="q" />

    <receiver android:name="com.geocomply.client.GeoComplyClientBroadcastReceiver" />
  </application>
</manifest>
```

### Application Requirements

Lucra uses [Coil](https://coil-kt.github.io/coil/) for images and SVGs. Provide the Lucra image loader in your `Application`:

```kotlin
class MyApplication : Application(), ImageLoaderFactory {
  override fun newImageLoader() = LucraCoilImageLoader.get(this)
}
```

### Firebase Crashlytics (Optional)

Add the Crashlytics Gradle plugin:

```gradle
// android/build.gradle
classpath 'com.google.firebase:firebase-crashlytics-gradle:2.9.8'
```

Apply the plugin in `android/app/build.gradle`:

```gradle
apply plugin: "com.google.firebase.crashlytics"
```

## Next Step

Once your project is set up, continue with initialization:

[LucraSDK Initialization](1.2.0_initialize_client.md)
