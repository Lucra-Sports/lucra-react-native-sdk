# Headless Functionality

Headless functions are API calls that do not display UI. Most require the SDK to be initialized and the user to be configured/logged in.

## Error Handling

`LucraSDK` throws errors with `code` values that you should map to user actions:

- `notInitialized`: SDK not ready or user not configured.
- `unverified`: User must verify identity.
- `notAllowed`: User is not permitted to perform the action.
- `insufficientFunds`: User must add funds.
- `missingDemographicInformation`: User must complete demographics.
- `unknown`: Unexpected error.

Example:

```ts
import { LucraSDK, type LucraSDKError } from '@lucra-sports/lucra-react-native-sdk';

function handleLucraSDKError(e: LucraSDKError) {
  switch (e.code) {
    case 'notInitialized':
      LucraSDK.present({ name: LucraSDK.FLOW.ONBOARDING });
      break;
    case 'unverified':
      LucraSDK.present({ name: LucraSDK.FLOW.VERIFY_IDENTITY });
      break;
    case 'insufficientFunds':
      LucraSDK.present({ name: LucraSDK.FLOW.ADD_FUNDS });
      break;
    case 'missingDemographicInformation':
      LucraSDK.present({ name: LucraSDK.FLOW.DEMOGRAPHIC_COLLECTION });
      break;
    default:
      console.warn('Lucra error', e);
  }
}
```

## User Configuration

Provide user information so Lucra can create or update the user profile:

```ts
await LucraSDK.configureUser({
  firstName: 'Mike',
  address: {
    address: 'New York',
  },
});

const user = await LucraSDK.getUser();
```

### Required/Optional Fields

Field requirements depend on your program configuration. At minimum, pass the fields you have available. The SDK will prompt for missing information when necessary.

## Games Matchups (Headless)

```ts
const matchup = await LucraSDK.getGamesMatchup(matchupId);
```

```ts
const res = await LucraSDK.createGamesMatchup('DARTS', 1.0);
const matchupId = res.id;
```
## User Listener

Subscribe to user updates:

```ts
const unsubscribe = LucraSDK.addListener('user', ({ user, error }) => {
  if (error) {
    console.log('user callback error', error);
    return;
  }

  if (user == null) {
    console.log('User is null (logged out)');
  } else {
    console.log('Received user', user);
  }
});

// Call this when you no longer need the listener (e.g., on unmount).
unsubscribe();
```

## Full Screen Flow Dismissed Listener

```ts
const unsubscribe = LucraSDK.addLucraFlowDismissedListener((flow) => {
  console.log('flow dismissed', flow);
});

// Call this when you no longer need the listener (e.g., on unmount).
unsubscribe();
```
